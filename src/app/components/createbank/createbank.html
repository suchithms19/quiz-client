<div class="createbank">
  <div class="createbank__header">
    <h1 class="createbank__header-title">Create Quiz Bank</h1>
  </div>

  <div class="createbank__container">
    <form class="createbank__form" (ngSubmit)="onSubmit()" #quizForm="ngForm" novalidate>
      
      <div class="createbank__section">
        <h2 class="createbank__section-title">Quiz Information</h2>
        
        <div class="createbank__form-group">
          <label for="quiz_name" class="createbank__form-group-label">Quiz Name <span style="color: red;">*</span> </label>
          <input 
            type="text" 
            id="quiz_name" 
            name="quiz_name"
            [(ngModel)]="quizData.name" 
            required
            placeholder="Enter quiz name"
            class="createbank__input">
        </div>
        
        <div class="createbank__form-group">
          <label for="category" class="createbank__form-group-label">Category <span style="color: red;">*</span> </label>
          <select 
            id="category" 
            name="category"
            [(ngModel)]="quizData.category" 
            required
            class="createbank__input">
            <option value="">Select a category</option>
            <option value="programming">Programming</option>
            <option value="mathematics">Mathematics</option>
            <option value="science">Science</option>
            <option value="history">History</option>
            <option value="language">Language</option>
            <option value="general">General Knowledge</option>
            <option value="other">Other</option>
          </select>
        </div>

        <div class="createbank__form-group">
          <label for="status" class="createbank__form-group-label">Status <span style="color: red;">*</span></label>
          <div class="radio-group">
            <label class="radio-label">
              <input 
                type="radio" 
                name="status" 
                [value]="true" 
                [(ngModel)]="quizData.status" 
                required>
              <span class="radio-custom"></span>
              Active
            </label>
            <label class="radio-label">
              <input 
                type="radio" 
                name="status" 
                [value]="false" 
                [(ngModel)]="quizData.status" 
                required>
              <span class="radio-custom"></span>
              Inactive
            </label>
          </div>
        </div>
      </div>

      <div class="createbank__section">
        <div class="createbank__section-header">
          <h2>Questions ({{ quizData.questions.length }})</h2>
          <button type="button" class="createbank__btn createbank__btn--add-question" (click)="addQuestion()">
            + Add Question
          </button>
        </div>

        <div class="createbank__questions-list" *ngIf="quizData.questions.length > 0">
          <div 
            class="createbank__questions-item" 
            *ngFor="let question of quizData.questions; let questionIndex = index">
            
            <div class="createbank__questions-header">
              <h3>Question {{ questionIndex + 1 }}</h3>
              <button 
                type="button" 
                class="createbank__btn createbank__btn--remove" 
                (click)="removeQuestion(questionIndex)"
                [disabled]="quizData.questions.length <= 1">
                Remove
              </button>
            </div>

            <div class="createbank__form-group">
              <label [for]="'question_' + questionIndex" class="createbank__form-group-label">Question Text <span style="color: red;">*</span></label>
              <textarea 
                [id]="'question_' + questionIndex"
                [name]="'question_' + questionIndex"
                [(ngModel)]="question.description" 
                required
                placeholder="Enter your question here..."
                class="createbank__textarea"
                rows="3"></textarea>
            </div>

            <div class="options-section">
              <h4>Answer Options</h4>
              
              <div 
                class="option-item" 
                *ngFor="let option of question.options; let optionIndex = index">
                
                <div class="option-input-group">
                  <label class="radio-label">
                    <input 
                      type="radio" 
                      [name]="'correct_' + questionIndex" 
                      [checked]="option.isCorrect"
                      (change)="setCorrectOption(questionIndex, optionIndex)">
                    <span class="radio-custom"></span>
                    Correct
                  </label>
                  
                  <input 
                    type="text"
                    [(ngModel)]="option.text"
                    [name]="'option_' + questionIndex + '_' + optionIndex"
                    required
                    placeholder="Enter answer option..."
                    class="createbank__input option-text">
                  
                  <button 
                    type="button" 
                    class="createbank__btn createbank__btn--remove" 
                    (click)="removeOption(questionIndex, optionIndex)"
                    [disabled]="question.options.length <= 2">
                    Ã—
                  </button>
                </div>
              </div>

              <button 
                type="button"
                *ngIf="question.options.length < 4"
                class="createbank__btn createbank__btn--add-option" 
                (click)="addOption(questionIndex)">
                + Add Option
              </button>
            </div>
          </div>
        </div>

        <div class="empty-state" *ngIf="quizData.questions.length === 0">
          <p>No questions added yet. Click "Add Question" to get started!</p>
        </div>
      </div>

      <div class="createbank__section submit-section">
        <!-- Status Messages -->
        <div class="createbank__status">
          <div class="createbank__status-success" *ngIf="successMessage">
            {{ successMessage }}
          </div>
          <div class="createbank__status-error" *ngIf="validationError">
            {{ validationError }}
          </div>
          <div class="createbank__status-error" *ngIf="errorMessage$ | async as errorMessage">
            {{ errorMessage }}
          </div>
        </div>
        
        <div class="form-actions">
          <button 
            type="button" 
            class="createbank__btn createbank__btn--secondary" 
            (click)="resetForm()">
            Reset Form
          </button>
          <button 
            type="submit" 
            class="createbank__btn createbank__btn--primary">
            <span *ngIf="isLoading$ | async">Creating...</span>
            <span *ngIf="!(isLoading$ | async)">Create Quiz Bank</span>
          </button>
        </div>
      </div>
    </form>
  </div>
</div>